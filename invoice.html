<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SpecSec Invoice</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; max-width: 900px; }
    .row { display: flex; justify-content: space-between; }
    .column { flex: 1; padding: 10px; }
    input, textarea { width: 100%; padding: 6px; margin-top: 4px; margin-bottom: 12px; font-size: 14px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #aaa; padding: 8px; text-align: left; }
    button { margin-top: 20px; padding: 10px 15px; font-size: 16px; }
    h2, h3 { margin-top: 0; }
  </style>
</head>
<body>
  <h2>SpecSec Invoice</h2>

  <div class="row">
    <div class="column">
      <label>Your Company Name</label>
      <input id="companyName" value="NAME AS APPEARS ON BANK STATEMENT">
      <input id="address1" value="ADDRESS LINE 1">
      <input id="address2" value="ADDRESS LINE 2">
      <input id="address3" value="ADDRESS LINE 3">
      <input id="postcode" value="POST CODE">
      <input id="phone" value="TELEPHONE NUMBER">
      <input id="email" value="EMAIL ADDRESS">
    </div>
    <div class="column">
      <label>Invoice #</label>
      <input id="invoiceNumber" value="INV-001">
      <label>Invoice Date</label>
      <input id="invoiceDate" type="date" value="2025-07-22">
    </div>
  </div>

  <h3>Billed To</h3>
  <input id="clientName" value="Specialized Security">
  <input id="clientAddress1" value="3 Lindsay Square">
  <input id="clientAddress2" value="Livingston">
  <input id="clientPostcode" value="EH54 8RL">
  <input id="clientPhone" value="01506 249001">
  <input id="clientEmail" value="military@specializedsecurity.co.uk">

  <table id="workTable">
    <thead>
      <tr>
        <th>Date</th><th>Role</th><th>Festival</th><th>Hours</th><th>Rate</th><th>Total</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><input type="date"></td>
        <td><input></td>
        <td><input></td>
        <td><input type="number" class="hours" value="0"></td>
        <td><input type="number" class="rate" value="0"></td>
        <td class="lineTotal">0.00</td>
      </tr>
      <tr>
        <td><input type="date"></td>
        <td><input></td>
        <td><input></td>
        <td><input type="number" class="hours" value="0"></td>
        <td><input type="number" class="rate" value="0"></td>
        <td class="lineTotal">0.00</td>
      </tr>
    </tbody>
  </table>

  <p><strong>Total Hours:</strong> <span id="totalHours">0</span></p>
  <p><strong>Total Amount:</strong> Â£<span id="totalAmount">0.00</span></p>

  <h3>Payment Details</h3>
  <label>Payment Method</label>
  <input id="paymentMethod" value="BACS">
  <label>Bank</label>
  <input id="bankName" value="BANK NAME">

  <button onclick="generatePDF()">Download PDF</button>

  <script>
    function recalculate() {
      let totalHours = 0;
      let totalAmount = 0;
      document.querySelectorAll("#workTable tbody tr").forEach(row => {
        const hours = parseFloat(row.querySelector(".hours").value) || 0;
        const rate = parseFloat(row.querySelector(".rate").value) || 0;
        const lineTotal = hours * rate;
        row.querySelector(".lineTotal").innerText = lineTotal.toFixed(2);
        totalHours += hours;
        totalAmount += lineTotal;
      });
      document.getElementById("totalHours").innerText = totalHours;
      document.getElementById("totalAmount").innerText = totalAmount.toFixed(2);
    }
    document.querySelectorAll(".hours, .rate").forEach(input => {
      input.addEventListener("input", recalculate);
    });
    recalculate();

    async function generatePDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF('p', 'pt', 'a4');
      await html2canvas(document.body).then(canvas => {
        const imgData = canvas.toDataURL("image/png");
        const imgProps = doc.getImageProperties(imgData);
        const pdfWidth = doc.internal.pageSize.getWidth();
        const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
        doc.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
        doc.save("specsec_invoice.pdf");
      });
    }
  </script>
</body>
</html>
